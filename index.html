<!DOCTYPE html>
<html lang="en">
  <head>
    <link href="https://unpkg.com/@csstools/normalize.css" rel="stylesheet" />

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" href="main.css" />
    <!-- Module shim (so import maps work everywhere) -->
    <script
      async
      src="https://unpkg.com/es-module-shims@1.10.0/dist/es-module-shims.js"
    ></script>

    <script type="module" src="app.js"></script>

    <title>Transcendence</title>
  </head>

  <body>
    <body>
    <!-- Spectral Sine Wave Background Canvas -->
    <canvas
      id="spectralSineWaveBg"
      style="
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        z-index: 0;
        pointer-events: none;
      "
    ></canvas>
    
    <audio id="woosh" src="music/woosh.mp3" preload="auto"></audio>
    <audio id="bg-music" src="music/3dC_theme.mp3" autoplay loop></audio>
    <audio id="transcend-3" src="music/transcend_3.wav" preload="auto"></audio>
    <audio id="evolve_effect_2" src="music/evolve_effect.wav"></audio>
    <audio id="transcend-4" src="music/transcend_4.wav" preload="auto"></audio>
    <audio id="evolution-sound" src="music/evolution.wav" preload="auto">
      <source src="music/evolution.wav" type="audio/wav" />
    </audio>
    <audio id="egg-hatch" src="music/egg_hatch.wav" preload="auto"></audio>
    <audio
      id="space-engine"
      src="music/space_engine.wav"
      preload="auto"
    ></audio>
    <audio id="stutterMask" src="music/stutterMask.wav" preload="auto"></audio>

    <!-- Page overlay - dims everything until Start is clicked -->
    <div id="pageOverlay" class="page-overlay">
      <div class="overlay-content">
        <h2>üéÆ Welcome to Transcendence! üéÆ</h2>
        <p>
          <span class="word">A</span>
          <span class="word">virtual</span>
          <span class="word">lifeform</span>
          <span class="word">is</span>
          <span class="word">waiting</span>
          <span class="word">to hatch</span>
          <span class="word">from</span>
          <span class="word">its</span>
          <span class="word">shell</span>
          <span class="word">to</span>
          <span class="word">evolve</span>
          <span class="word">beyond</span>
          <span class="word">time</span>
          <span class="word">and</span>
          <span class="word">form.</span>
        </p>
        <p>
          <span class="word">Feed,</span>
          <span class="word">dance,</span>
          <span class="word">sleep,</span>
          <span class="word">have fun,</span>
          <span class="word">evolve</span>
          <span class="word">and</span>
        </p>
        <p>
          <span class="word">transcend.</span>
        </p>
        <button class="OverlayStartButton" id="overlayStartButton">
          START GAME
        </button>
      </div>
    </div>

    <!-- Pet Name Input Overlay -->
    <div id="nameOverlay" class="page-overlay" style="display: none">
      <div class="overlay-content">
        <h2>
          <svg width="58" height="58" viewBox="0 0 32 32" style="vertical-align: middle; margin-right: 8px;" class="crystal-icon-left">
            <defs>
              <linearGradient id="crystalGradient1" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:oklch(77.194% 0.17376 64.545);stop-opacity:1" />
                <stop offset="25%" style="stop-color:oklch(87.027% 0.28955 141.531);stop-opacity:1" />
                <stop offset="50%" style="stop-color:oklch(89.994% 0.15767 186.289);stop-opacity:1" />
                <stop offset="75%" style="stop-color:oklch(56.347% 0.24089 260.834);stop-opacity:1" />
                <stop offset="100%" style="stop-color:oklch(64.532% 0.26038 2.454);stop-opacity:1" />
              </linearGradient>
              <radialGradient id="crystalGlow1">
                <stop offset="0%" style="stop-color:oklch(89.994% 0.15767 186.289);stop-opacity:0.6" />
                <stop offset="100%" style="stop-color:oklch(56.347% 0.24089 260.834);stop-opacity:0" />
              </radialGradient>
            </defs>
            <g>
              <!-- Crystal facets -->
              <path d="M16 2 L24 12 L16 30 L8 12 Z" fill="url(#crystalGlow1)" stroke="url(#crystalGradient1)" stroke-width="1.5"/>
              <path d="M16 2 L24 12 L16 16 Z" fill="url(#crystalGradient1)" opacity="0.4"/>
              <path d="M16 2 L8 12 L16 16 Z" fill="url(#crystalGradient1)" opacity="0.6"/>
              <path d="M16 16 L24 12 L16 30 Z" fill="url(#crystalGradient1)" opacity="0.3"/>
              <path d="M16 16 L8 12 L16 30 Z" fill="url(#crystalGradient1)" opacity="0.5"/>
              <!-- Inner glow line -->
              <line x1="16" y1="8" x2="16" y2="24" stroke="url(#crystalGradient1)" stroke-width="1.5" opacity="0.8"/>
            </g>
          </svg>
          Name Your Pet
          <svg width="58" height="58" viewBox="0 0 32 32" style="vertical-align: middle; margin-left: 8px;" class="crystal-icon-right">
            <defs>
              <linearGradient id="crystalGradient2" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:oklch(77.194% 0.17376 64.545);stop-opacity:1" />
                <stop offset="25%" style="stop-color:oklch(87.027% 0.28955 141.531);stop-opacity:1" />
                <stop offset="50%" style="stop-color:oklch(89.994% 0.15767 186.289);stop-opacity:1" />
                <stop offset="75%" style="stop-color:oklch(56.347% 0.24089 260.834);stop-opacity:1" />
                <stop offset="100%" style="stop-color:oklch(64.532% 0.26038 2.454);stop-opacity:1" />
              </linearGradient>
              <radialGradient id="crystalGlow2">
                <stop offset="0%" style="stop-color:oklch(89.994% 0.15767 186.289);stop-opacity:0.6" />
                <stop offset="100%" style="stop-color:oklch(56.347% 0.24089 260.834);stop-opacity:0" />
              </radialGradient>
            </defs>
            <g>
              <!-- Crystal facets -->
              <path d="M16 2 L24 12 L16 30 L8 12 Z" fill="url(#crystalGlow2)" stroke="url(#crystalGradient2)" stroke-width="1.5"/>
              <path d="M16 2 L24 12 L16 16 Z" fill="url(#crystalGradient2)" opacity="0.4"/>
              <path d="M16 2 L8 12 L16 16 Z" fill="url(#crystalGradient2)" opacity="0.6"/>
              <path d="M16 16 L24 12 L16 30 Z" fill="url(#crystalGradient2)" opacity="0.3"/>
              <path d="M16 16 L8 12 L16 30 Z" fill="url(#crystalGradient2)" opacity="0.5"/>
              <!-- Inner glow line -->
              <line x1="16" y1="8" x2="16" y2="24" stroke="url(#crystalGradient2)" stroke-width="1.5" opacity="0.8"/>
            </g>
          </svg>
        </h2>
        <p>What will you call your virtual companion?</p>
        <input 
          type="text" 
          id="petNameInput" 
          class="pet-name-input"
          placeholder="Enter pet name..."
          maxlength="15"
          autocomplete="off"
        />
        <button class="OverlayStartButton" id="confirmNameBtn">
          CONFIRM
        </button>
      </div>
    </div>

    <div class="scaling-root">
      <!-- transcendence was here -->

      <header>
        <h1>TAMAGOTCHI</h1>
      </header>
      <!-- I gave main-wrapper an id, but it is still main, following David's example, although he didn't assign an id to it -->
      <main id="main-wrapper">
        <button class="CornerRoundButton" id="infoDropdownBtn"></button>
        <div class="dropdown-container">
          <!-- Dropdown menu (hidden by default) -->
          <div
            id="infoDropdownMenu"
            class="dropdown-menu"
            style="display: none"
          >
            <ul>
              <li><strong>How to Transcend:</strong></li>
              <li>Feed your pet when it hungers.</li>
              <li>Dance to energize and uplift its spirits</li>
              <li>Let it rest when it tires.</li>
              <li>
                Train its body to unify body, mind and spirit, bringing his
                life-force into balance.
              </li>
              <li>
                Stay balanced - joy, rest, physical training, and nourishment
                and your compassion are the keys.
              </li>
              <li>Each stage brings new color, emotional stage and form.</li>
              <li>
                Final form leads to transcendence - the end of a cylce in this
                dimension, and on to a higher one.
              </li>
              <li>Press START to begin, RESET to start over</li>
            </ul>
          </div>
        </div>

        <span id="transcendence">TRANSCENDENCE</span>

        <!-- Sonic gif - hidden initially, shown after start button -->

        <!-- pet parent is the "screen" compared to D's ie. -->

        <div id="pet-container">
          <!-- Colorful glitch animation container - shown by default -->
          <div id="colorfulGlitchDiv" class="colorful-glitch-container">
            <div class="colorful-glitch-text">In Utero</div>
            <div class="colorful-glitch-overlay"></div>
            <div class="colorful-glitch-particles"></div>
            <div class="colorful-glitch-border"></div>
          </div>

          <!-- Glitch stutter overlay for animation transitions -->
          <div id="glitchStutterOverlay" class="glitch-stutter-overlay">
            <div class="stutter-scanlines"></div>
            <div class="stutter-static"></div>
            <div class="stutter-flash"></div>
            <div class="radial-burst-ring"></div>
          </div>

          <!-- Second glitch overlay layer with inverted colors -->
          <div
            id="glitchStutterOverlay2"
            class="glitch-stutter-overlay glitch-inverted"
          >
            <div class="stutter-scanlines"></div>
            <div class="stutter-static"></div>
            <div class="stutter-flash"></div>
          </div>
        </div>
        <div class="infoBox">
          <div class="infoBox-controls">
            <div class="button-container">
              <button class="Buttons feed-btn" id="feed-button">FEED</button>
              <div class="stat-bar-container">
                <div class="stat-bar hunger-bar">
                  <div class="stat-bar-fill" id="hungerBar" style="width: 0%"></div>
                </div>
                <span class="stat-label">Hunger: <span id="hungerValue">0</span></span>
              </div>
            </div>
            <div class="button-container">
              <button class="Buttons dance-btn" id="dance-button">DANCE</button>
              <div class="stat-bar-container">
                <div class="stat-bar fun-bar">
                  <div class="stat-bar-fill" id="funBar" style="width: 100%"></div>
                </div>
                <span class="stat-label">Fun: <span id="funValue">10</span></span>
              </div>
            </div>
            <div class="button-container">
              <button class="Buttons sleep-btn" id="sleep-button">SLEEP</button>
              <div class="stat-bar-container">
                <div class="stat-bar sleep-bar">
                  <div class="stat-bar-fill" id="sleepBar" style="width: 0%"></div>
                </div>
                <span class="stat-label">Sleep: <span id="sleepValue">0</span></span>
              </div>
            </div>
            <div class="button-container">
              <button class="Buttons train-btn" id="power-button">TRAIN</button>
              <div class="stat-bar-container">
                <div class="stat-bar power-bar">
                  <div class="stat-bar-fill" id="powerBar" style="width: 100%"></div>
                </div>
                <span class="stat-label">Power: <span id="powerValue">10</span></span>
              </div>
            </div>
          </div>

          <div class="infoBox_petChat">Hello! turns out I'm your new pet!</div>
        </div>
      </main>

      <!-- scaling root end -->
      <!-- Game Over Overlay -->

      <div id="gameOverOverlay" class="game-over-overlay" style="display: none">
        <div class="game-over-content">
          <h2 class="glitch-text">GAME OVER</h2>
          <p id="gameOverReason">Your pet has transcended...</p>
          <div class="game-over-buttons">
            <button class="game-over-button" id="tryAgainBtn">TRY AGAIN</button>
          </div>
        </div>
      </div>

      <!-- Win / Transcendence Overlay -->
      <div id="winOverlay" class="game-over-overlay" style="display: none">
        <div class="game-over-content">
          <h2 id="transcendence">TRANSCENDENCE</h2>
          <p id="winReason">Your pet has transcended...</p>
          <div class="game-over-buttons"></div>
        </div>
      </div>

      <div class="startButtonContainer">
        <button class="StartButton">START</button>
        <button class="ResetButton">RESET</button>
        <!-- Debug button for testing transcendence -->
        <button class="ResetButton" id="debugTranscendBtn" style="background: oklch(55.657% 0.27058 200); margin-left: 10px;">DEBUG TRANSCEND</button>
        <!-- scaling root end -->
      </div>
    </div>
    <!-- Full-screen Cyberpunk Transition Overlay -->

    <!-- ‚úÖ Transcendence Win Overlay (outside scaling-root to avoid transform issues) -->
    <div id="transcendenceOverlay" class="overlay" style="display: none">
      <div class="transcendence-overlay-content">
        <h2 class="transcendence-title gradient-text">TRANSCENDENCE</h2>
        <p class="transcendence-message gradient-text">
          ‚ú®üëÅ TRANSCENDENCE COMPLETE üëÅ‚ú®<br />
          Your pet has mastered the art of care and transcended beyond
          existence.<br />
          The ultimate evolution has been achieved through perfect balance.
        </p>
        <button id="playAgainBtn" class="btn-play-again">
          <span class="gradient-text">PLAY AGAIN</span>
        </button>
      </div>
    </div>

</div>
  </body>
</html>
